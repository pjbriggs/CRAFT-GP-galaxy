<tool id="visualise_credible_snps" name="Visualise credible SNPs" version="0.1.0">
  <requirements>
    <requirement type="package" version="0.0.0">CRAFT-GP</requirement>
    <requirement type="package" version="3.2.1">R</requirement>
    <requirement type="package" version="1.16.1">Gviz</requirement>
    <requirement type="package" version="2.28.0">biomaRt</requirement>
  </requirements>
  <stdio>
    <exit_code range="1:" />
  </stdio>
  <command><![CDATA[
  mkdir -p output/plots/
  && ln -s \$CRAFT_GP_DATA
  && Rscript --vanilla \$CRAFT_GP_SCRIPTS/visualisation_main.R
  -r "$summary_table"
  -s "$credible_snps_bed"
  -e "$epigenomes"
  -o output/plots/
  ]]></command>
  <inputs>
    <param type="data" name="summary_table" format="txt" />
    <param type="data" name="credible_snps_bed" format="bed" />
    <param type="text" name="epigenomes" value="E116" />
  </inputs>
  <outputs>
    <!-- Capture arbitrary number of outputs
	 See https://wiki.galaxyproject.org/Admin/Tools/Multiple%20Output%20Files#Number_of_Output_datasets_cannot_be_determined_until_tool_run
	 Not sure if this is correctly implemented below however -->
    <data format="pdf" name="report">
      <discover_datasets pattern="__designation__"
			 ext="pdf"
			 directory="output/plots"
			 visible="true" />
    </data>
  </outputs>
  <tests>
    <test>
      <param name="summary_table" value="credible_snps_summary_table.out"/>
      <param name="credible_snps_bed" value="credible_snps_bed.out"/>
      <param name="epigenomes" value="E116"/>
      <output name="report1" file="rs2224873.pdf"/>
      <output name="report2" file="rs7536201.pdf"/>
      <output name="report3" file="rs9988642.pdf"/>
    </test>
  </tests>
  <help><![CDATA[
.. class:: infomark

**What it does**

Produces PDFs for credible SNPs.
  
.. class:: infomark

**Usage**
    ]]></help>
  <citations>
    <citation type="bibtex">
      @misc{githubCRAFT-GP,
      author = {Bowes, John},
      year = {2016},
      title = {CRAFT-GP},
      publisher = {GitHub},
      journal = {GitHub repository},
      url = {https://github.com/johnbowes/CRAFT-GP},
}</citation>
  </citations>
</tool>
